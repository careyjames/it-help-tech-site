(()=>{const d=document.documentElement,k="theme",btn=document.getElementById("mode");

/* ---------- 1.  apply stored choice OR default dark ---------- */
const pref=localStorage.getItem(k);
if(pref==="light"){d.removeAttribute("data-theme");}
else{d.dataset.theme="dark";/* pref==="dark" OR first visit */}

/* ---------- 2.  toggle & remember ---------------------------- */
btn&&btn.addEventListener("click",()=>{const dark=(d.dataset.theme==="dark");
if(dark){d.removeAttribute("data-theme");localStorage.setItem(k,"light");}
else {d.dataset.theme="dark";       localStorage.setItem(k,"dark");}});
})();
