(() => {
  const root   = document.documentElement;
  const key    = 'theme';
  const toggle = document.getElementById('mode');

  /* 1 – apply saved preference (if any) */
  const saved = localStorage.getItem(key);
  if (saved) {
    root.dataset.theme = saved;        // 'dark'  or  'light'
  } else {
    root.dataset.theme = 'dark';       // default first-visit
  }

  /* 2 – switch + persist on click   */
  toggle?.addEventListener('click', () => {
    if (root.dataset.theme === 'dark') {
      root.dataset.theme = 'light';
      localStorage.setItem(key, 'light');
    } else {
      root.dataset.theme = 'dark';
      localStorage.setItem(key, 'dark');
    }
  });
})();
